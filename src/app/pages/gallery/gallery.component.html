<div class="px-2 pt-4 sm:px-4 sm:pt-8 md:pt-12">
  <h2
    class="text-love-500 mb-8 px-4 text-center text-3xl font-bold sm:mb-12 sm:text-4xl md:text-5xl"
  >
    Our Beautiful Memories
  </h2>
  <div
    class="mx-auto grid max-w-7xl grid-cols-2 gap-3 sm:grid-cols-3 sm:gap-4 md:grid-cols-4 lg:grid-cols-5"
  >
    <div
      *ngFor="let photo of photos; trackBy: trackByPhotoUrl"
      class="group relative"
    >
      <div
        class="aspect-square transform cursor-pointer overflow-hidden rounded-lg transition-transform duration-300 hover:scale-105 sm:rounded-xl"
        (click)="openModal(photo)"
      >
        <img
          [src]="photo"
          class="h-full w-full object-cover shadow-lg"
          alt="Memory photo"
        />
      </div>
    </div>
  </div>

  <div class="mt-8 mb-8 pb-6 text-center sm:mt-12">
    <button
      routerLink="/"
      class="bg-love-500 hover:bg-love-600 transform cursor-pointer rounded-full px-6 py-3 text-base text-white shadow-lg transition-all duration-300 hover:scale-105 sm:px-8 sm:py-4 sm:text-lg"
    >
      Back to Love Notes ❤️
    </button>
  </div>
</div>

<!-- Modal -->
<div
  *ngIf="selectedPhoto"
  role="dialog"
  aria-modal="true"
  aria-label="Photo viewer"
  class="bg-love-300/50 fixed inset-0 z-50 flex items-center justify-center p-2 backdrop-blur-sm sm:p-4 md:p-8"
  (click)="closeModal()"
>
  <!-- Falling Hearts -->
  <div
    class="pointer-events-none fixed inset-x-0 -top-10 h-full overflow-hidden"
    aria-hidden="true"
  >
    <div
      *ngFor="let heart of hearts; trackBy: trackByHeartId"
      class="animate-fall heart absolute text-sm sm:text-base"
      [ngStyle]="{
        left: heart.left,
        'animation-duration': heart.animationDuration,
        'animation-delay': heart.delay,
        width: heart.size,
        height: heart.size,
      }"
    >
      ❤️
    </div>
  </div>

  <!-- photo -->
  <div class="flex h-full w-full items-center justify-center">
    <!-- Previous button -->
    <button
      *ngIf="canGoPrevious"
      (click)="previousPhoto(); $event.stopPropagation()"
      aria-label="Previous photo"
      class="hover:text-love-200 bg-love-500/80 hover:bg-love-500 absolute left-2 z-10 cursor-pointer rounded-full p-2 text-white transition-all sm:left-4 sm:p-3"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="h-6 w-6 sm:h-8 sm:w-8"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
        aria-hidden="true"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M15 19l-7-7 7-7"
        />
      </svg>
    </button>

    <div
      class="relative rounded-lg bg-white p-4 sm:p-6 md:p-8"
      (click)="$event.stopPropagation()"
    >
      <!-- Close button -->
      <button
        (click)="closeModal()"
        aria-label="Close photo viewer"
        class="absolute top-2 right-2 z-10 cursor-pointer rounded-full bg-white/80 p-1 text-black hover:text-gray-500 sm:top-3 sm:right-3"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-5 w-5 sm:h-6 sm:w-6"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
          aria-hidden="true"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M6 18L18 6M6 6l12 12"
          />
        </svg>
      </button>

      <!-- Modal content -->
      <div class="relative overflow-hidden rounded-lg">
        <img
          [src]="selectedPhoto"
          class="h-auto max-h-[85vh] w-auto sm:max-h-[80vh]"
          alt="Selected memory photo"
        />
      </div>

      <!-- Photo counter -->
      <div class="mt-3 flex items-center justify-center gap-2 sm:mt-4">
        <div
          class="bg-love-500 rounded-full px-3 py-1 text-xs font-semibold text-white shadow-md sm:px-4 sm:py-1.5 sm:text-sm"
        >
          {{ currentPhotoIndex + 1 }} <span class="text-love-200 mx-1">/</span>
          {{ photos.length }}
        </div>
      </div>
    </div>

    <!-- Next button -->
    <button
      *ngIf="canGoNext"
      (click)="nextPhoto(); $event.stopPropagation()"
      aria-label="Next photo"
      class="hover:text-love-200 bg-love-500/80 hover:bg-love-500 absolute right-2 z-10 cursor-pointer rounded-full p-2 text-white transition-all sm:right-4 sm:p-3"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="h-6 w-6 sm:h-8 sm:w-8"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
        aria-hidden="true"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M9 5l7 7-7 7"
        />
      </svg>
    </button>
  </div>
</div>
